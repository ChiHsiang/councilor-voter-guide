{% extends "base.html" %}
{% load socialaccount %}

{% block title %}
    <title>議員投票指南:民眾（{{platform.user.last_name}}{{platform.user.first_name}}）的願望</title>
    <meta property="og:title" content="議員投票指南:民眾（{{platform.user.last_name}}{{platform.user.first_name}}）的願望"/>
    <meta itemprop="name" content="議員投票指南:民眾（{{platform.user.last_name}}{{platform.user.first_name}}）的願望">
    <link href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css" rel="stylesheet">
    <style>
        .CodeMirror, .CodeMirror-scroll {
            display: none;
        }
    </style>
{% endblock title %}

{% block right %}
    <div class="page-header text-center">
        <h2>民眾（{{platform.user.last_name}}{{platform.user.first_name}}）的願望 <small><i class="fa fa-thumbs-up"> {{platform.likes}}</i></small></h2>
        {% if request.user.is_authenticated %}
            <form class="form" action="" method="post">{% csrf_token %}
            {% if user_liked %}
                <button class="btn btn-success" type="submit" name="decision" value="downvote"><i class="fa fa-thumbs-up"> 收回讚</i></button>
            {% else %}
                <button class="btn btn-success" type="submit" name="decision" value="upvote"><i class="fa fa-thumbs-up"> 讚</i></button>
            {% endif %}
            </form>
        {% else %}
            <a href="{% provider_login_url "facebook" %}?next={% url 'platforms:detail' platform_id=platform.uid %}" class="btn btn-success"><i class="fa fa-sign-in"> 登入按讚</i></a>
        {% endif %}
    </div>
    <div class="row">
        <div class="col-sm-offset-3 col-sm-6">
            <div class="property-header">縣市</div>
            <div class="property-body county">{{platform.county}}</div>
            <div class="property-header">願望：</div>
            <textarea style="display: none">{{platform.content}}</textarea>
            <div class="property-body"></div>
        </div>
    </div>
    <div id="disqus_thread"></div>
{% endblock right %}

{% block script %}
    <script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
    <script>
        $(document).ready( function() {
            $('#intents').addClass('active');
            $("textarea").each( function() {
                var simplemde = new SimpleMDE({ element: $(this)[0], toolbar: false , status: false});
                var renderedHTML = simplemde.options.previewRender(simplemde.value());
                var property_body = $(this).nextAll('div.property-body:first');
                property_body.html(renderedHTML);
                property_body.children('table').addClass('table table-bordered table-condensed');
            });
            $("[rel='tooltip']").tooltip();
        });
    </script>
{% endblock script %}
